<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Xenomai API: Channels and ranges</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Channels and ranges<br>
<small>
[<a class="el" href="group__driverfacilities.html">Driver API.</a>]</small>
</h1>
<p>
<div class="dynheader">
Collaboration diagram for Channels and ranges:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__channelrange.png" border="0" alt="" usemap="#group____channelrange_map">
<map name="group____channelrange_map">
<area shape="rect" href="group__driverfacilities.html" title="Driver API." alt="" coords="5,5,91,32"></map></td></tr></table></center>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcomedi__channel.html">comedi_channel</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure describing some channel's characteristics.  <a href="structcomedi__channel.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcomedi__channels__desc.html">comedi_channels_desc</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure describing a channels set.  <a href="structcomedi__channels__desc.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcomedi__range.html">comedi_range</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Structure describing a (unique) range.  <a href="structcomedi__range.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g92e174e2afdd9b2bb5997cb154d2d8a6"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_GLOBAL" ref="g92e174e2afdd9b2bb5997cb154d2d8a6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g92e174e2afdd9b2bb5997cb154d2d8a6">COMEDI_CHAN_GLOBAL</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal use flag (must not be used by driver developer). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g45013489fb359e4dc5a31796664abe9c">COMEDI_RNG_FACTOR</a>&nbsp;&nbsp;&nbsp;1000000</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constant for internal use only (must not be used by driver developer).  <a href="#g45013489fb359e4dc5a31796664abe9c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g55c8ea693c1ad8d026ace141b8e8a341"></a><!-- doxytag: member="channelrange::COMEDI_RNG_VOLT_UNIT" ref="g55c8ea693c1ad8d026ace141b8e8a341" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g55c8ea693c1ad8d026ace141b8e8a341">COMEDI_RNG_VOLT_UNIT</a>&nbsp;&nbsp;&nbsp;0x0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Volt unit range flag. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g8fd18860ee5a063b26af0bbb6348e9bf"></a><!-- doxytag: member="channelrange::COMEDI_RNG_MAMP_UNIT" ref="g8fd18860ee5a063b26af0bbb6348e9bf" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g8fd18860ee5a063b26af0bbb6348e9bf">COMEDI_RNG_MAMP_UNIT</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MilliAmpere unit range flag. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gf195d81ef3ab4a8cfdcdc68388da9157"></a><!-- doxytag: member="channelrange::COMEDI_RNG_NO_UNIT" ref="gf195d81ef3ab4a8cfdcdc68388da9157" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#gf195d81ef3ab4a8cfdcdc68388da9157">COMEDI_RNG_NO_UNIT</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">No unit range flag. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g51325b41f9f4e114c3354e5ff9766048"></a><!-- doxytag: member="channelrange::COMEDI_RNG_UNIT" ref="g51325b41f9f4e114c3354e5ff9766048" args="(x)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g51325b41f9f4e114c3354e5ff9766048">COMEDI_RNG_UNIT</a>(x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro to retrieve the range unit from the range flags. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g0474fa8d10ba03bba21761716b4a2965"></a><!-- doxytag: member="channelrange::COMEDI_RNG_GLOBAL" ref="g0474fa8d10ba03bba21761716b4a2965" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g0474fa8d10ba03bba21761716b4a2965">COMEDI_RNG_GLOBAL</a>&nbsp;&nbsp;&nbsp;0x4</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal use flag (must not be used by driver developer). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g9cb4bca9f87b9fb4a34d0db84323e32d"></a><!-- doxytag: member="channelrange::RANGE" ref="g9cb4bca9f87b9fb4a34d0db84323e32d" args="(x, y)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g9cb4bca9f87b9fb4a34d0db84323e32d">RANGE</a>(x, y)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro to declare a (unique) range with no unit defined. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g83f988df3128b75fe9b112eb1805d528"></a><!-- doxytag: member="channelrange::RANGE_V" ref="g83f988df3128b75fe9b112eb1805d528" args="(x, y)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g83f988df3128b75fe9b112eb1805d528">RANGE_V</a>(x, y)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro to declare a (unique) range in Volt. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g6d9b9f63e82704bf3b7d421bf81e09a5"></a><!-- doxytag: member="channelrange::RANGE_mA" ref="g6d9b9f63e82704bf3b7d421bf81e09a5" args="(x, y)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g6d9b9f63e82704bf3b7d421bf81e09a5">RANGE_mA</a>(x, y)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro to declare a (unique) range in milliAmpere. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g19f95994b7c74ab2274d16c78c6c2c64"></a><!-- doxytag: member="channelrange::COMEDI_RNG_GLOBAL_RNGDESC" ref="g19f95994b7c74ab2274d16c78c6c2c64" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g19f95994b7c74ab2274d16c78c6c2c64">COMEDI_RNG_GLOBAL_RNGDESC</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constant to define a ranges descriptor as global (inter-channel). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g3cbbb8a429ee7eb67191961166849117"></a><!-- doxytag: member="channelrange::COMEDI_RNG_PERCHAN_RNGDESC" ref="g3cbbb8a429ee7eb67191961166849117" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g3cbbb8a429ee7eb67191961166849117">COMEDI_RNG_PERCHAN_RNGDESC</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constant to define a ranges descriptor as specific for a channel. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gbb8a61456a5088a58dbd7392872af4f0"></a><!-- doxytag: member="channelrange::RNG_GLOBAL" ref="gbb8a61456a5088a58dbd7392872af4f0" args="(x)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#gbb8a61456a5088a58dbd7392872af4f0">RNG_GLOBAL</a>(x)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Macro to declare a ranges global descriptor in one line. <br></td></tr>
<tr><td colspan="2"><br><h2>Channel reference</h2></td></tr>
<tr><td colspan="2">Flags to define the channel's reference<p>
<a class="anchor" name="COMEDI_CHAN_AREF_xxx"></a> <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g9280587848771bdb5b891eb535bec3cb"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_AREF_GROUND" ref="g9280587848771bdb5b891eb535bec3cb" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g9280587848771bdb5b891eb535bec3cb">COMEDI_CHAN_AREF_GROUND</a>&nbsp;&nbsp;&nbsp;0x1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ground reference. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gb6401c01dbedf0d2ab5953d288a9962e"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_AREF_COMMON" ref="gb6401c01dbedf0d2ab5953d288a9962e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#gb6401c01dbedf0d2ab5953d288a9962e">COMEDI_CHAN_AREF_COMMON</a>&nbsp;&nbsp;&nbsp;0x2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Common reference. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g6e017b9b854135543d3536ab22b24194"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_AREF_DIFF" ref="g6e017b9b854135543d3536ab22b24194" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g6e017b9b854135543d3536ab22b24194">COMEDI_CHAN_AREF_DIFF</a>&nbsp;&nbsp;&nbsp;0x4</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Differential reference. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g03691cd68b128db323aacadcfc55f705"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_AREF_OTHER" ref="g03691cd68b128db323aacadcfc55f705" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g03691cd68b128db323aacadcfc55f705">COMEDI_CHAN_AREF_OTHER</a>&nbsp;&nbsp;&nbsp;0x8</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Misc reference. <br></td></tr>
<tr><td colspan="2"><br><h2>Channels declaration mode</h2></td></tr>
<tr><td colspan="2">Constant to define whether the channels in a descriptor are identical<p>
<a class="anchor" name="COMEDI_CHAN_xxx"></a> <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g05368eebf4ec72281ed14c4e7ac15191"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_GLOBAL_CHANDESC" ref="g05368eebf4ec72281ed14c4e7ac15191" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g05368eebf4ec72281ed14c4e7ac15191">COMEDI_CHAN_GLOBAL_CHANDESC</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global declaration, the set contains channels with similar characteristics. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g87b385cb6fcd9b27ee42c377bb364826"></a><!-- doxytag: member="channelrange::COMEDI_CHAN_PERCHAN_CHANDESC" ref="g87b385cb6fcd9b27ee42c377bb364826" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__channelrange.html#g87b385cb6fcd9b27ee42c377bb364826">COMEDI_CHAN_PERCHAN_CHANDESC</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Per channel declaration, the decriptor gathers differents channels. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Channels<p>
According to the Comedi nomenclature, the channel is the elementary acquisition entity. One channel is supposed to acquire one data at a time. A channel can be:<ul>
<li>an analog input or an analog ouput;</li><li>a digital input or a digital ouput;</li></ul>
<p>
Channels are defined by their type and by some other characteristics like:<ul>
<li>their resolutions for analog channels (which usually ranges from 8 to 32 bits);</li><li>their references;</li></ul>
<p>
Such parameters must be declared for each channel composing a subdevice. The structure <a class="el" href="structcomedi__channel.html" title="Structure describing some channel&#39;s characteristics.">comedi_channel</a> (comedi_chan_t) is used to define one channel.<p>
Another structure named <a class="el" href="structcomedi__channels__desc.html" title="Structure describing a channels set.">comedi_channels_desc</a> (comedi_chdesc_t) gathers all channels for a specific subdevice. This latter structure also stores :<ul>
<li>the channels count;</li><li>the channels declaration mode (COMEDI_CHAN_GLOBAL_CHANDESC or COMEDI_CHAN_PERCHAN_CHANDESC): if all the channels composing a subdevice are identical, there is no need to declare the parameters for each channel; the global declaration mode eases the structure composition.</li></ul>
<p>
Usually the channels descriptor looks like this: <code> <div class="fragment"><pre class="fragment">
comedi_chdesc_t example_chan = {
        mode: COMEDI_CHAN_GLOBAL_CHANDESC, -&gt; Global declaration
	                                      mode is set
        length: 8, -&gt; 8 channels
	chans: { 
	        {COMEDI_CHAN_AREF_GROUND, 16}, -&gt; Each channel is 16 bits
		                                  wide with the ground as
                                                  reference
	},
};
</pre></div> </code><p>
Ranges<p>
So as to perform conversion from logical values acquired by the device to physical units, some range structure(s) must be declared on the driver side.<p>
Such structures contain:<ul>
<li>the physical unit type (Volt, Ampere, none);</li><li>the minimal and maximal values;</li></ul>
<p>
These range structures must be associated with the channels at subdevice registration time as a channel can work with many ranges. At configuration time (thanks to a Comedi command), one range will be selected for each enabled channel.<p>
Consequently, for each channel, the developer must declare all the possible ranges in a structure called comedi_rngtab_t. Here is an example: <code> <div class="fragment"><pre class="fragment">
comedi_rngtab_t example_tab = {
    length: 2,
    rngs: {
	RANGE_V(-5,5),
	RANGE_V(-10,10),
    },
};
</pre></div> </code><p>
For each subdevice, a specific structure is designed to gather all the ranges tabs of all the channels. In this structure, called comedi_rngdesc_t, three fields must be filled:<ul>
<li>the declaration mode (COMEDI_RNG_GLOBAL_RNGDESC or COMEDI_RNG_PERCHAN_RNGDESC);</li><li>the number of ranges tab;</li><li>the tab of ranges tabs pointers;</li></ul>
<p>
Most of the time, the channels which belong to the same subdevice use the same set of ranges. So, there is no need to declare the same ranges for each channel. A macro is defined to prevent redundant declarations: <a class="el" href="group__channelrange.html#gbb8a61456a5088a58dbd7392872af4f0" title="Macro to declare a ranges global descriptor in one line.">RNG_GLOBAL()</a>.<p>
Here is an example: <code> <div class="fragment"><pre class="fragment">
comedi_rngdesc_t example_rng = RNG_GLOBAL(example_tab);
</pre></div> </code> <hr><h2>Define Documentation</h2>
<a class="anchor" name="g45013489fb359e4dc5a31796664abe9c"></a><!-- doxytag: member="channel_range.h::COMEDI_RNG_FACTOR" ref="g45013489fb359e4dc5a31796664abe9c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMEDI_RNG_FACTOR&nbsp;&nbsp;&nbsp;1000000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constant for internal use only (must not be used by driver developer). 
<p>

<p>Referenced by <a class="el" href="range_8c-source.html#l00083">comedi_find_range()</a>, <a class="el" href="range_8c-source.html#l00218">comedi_from_phys()</a>, and <a class="el" href="range_8c-source.html#l00152">comedi_to_phys()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Jun 18 13:51:03 2009 for Xenomai API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
